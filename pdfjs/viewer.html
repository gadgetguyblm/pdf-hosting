<script src="https://gadgetguyblm.github.io/pdf-hosting/build/pdf.js"></script>
<script>
  // Tell PDF.js where to find the worker
  pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://gadgetguyblm.github.io/pdf-hosting/build/pdf.worker.js";

  const url = "../2023-Trails-Book-Web-Version-reduced.pdf";

  const pageParam = parseInt(window.location.hash.replace("#page=", "")) || 1;

  let pdfDoc = null,
      pageNum = pageParam,
      scale = 1.0,
      canvas = document.getElementById("pdf-canvas"),
      ctx = canvas.getContext("2d");

  function renderPage(num) {
    pdfDoc.getPage(num).then(function(page) {
      const viewport = page.getViewport({ scale });
      canvas.height = viewport.height;
      canvas.width = viewport.width;

      page.render({ canvasContext: ctx, viewport }).promise.then(() => {
        document.getElementById("page_num").textContent = num;
      });
    });
  }

  pdfjsLib.getDocument(url).promise.then(function(pdf) {
    pdfDoc = pdf;
    document.getElementById("page_count").textContent = pdf.numPages;
    renderPage(pageNum);
  });

  // Controls
  document.getElementById("prev").addEventListener("click", () => {
    if (pageNum <= 1) return;
    pageNum--; renderPage(pageNum);
  });

  document.getElementById("next").addEventListener("click", () => {
    if (pageNum >= pdfDoc.numPages) return;
    pageNum++; renderPage(pageNum);
  });

  document.getElementById("zoomIn").addEventListener("click", () => {
    scale += 0.25; renderPage(pageNum);
  });

  document.getElementById("zoomOut").addEventListener("click", () => {
    if (scale <= 0.25) return;
    scale -= 0.25; renderPage(pageNum);
  });
</script>
