<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simple PDF.js Viewer</title>
  <style>
    body { margin: 0; background: #eee; text-align: center; }
    #controls { margin: 10px; }
    canvas { border: 1px solid black; margin-top: 10px; }
  </style>
</head>
<body>
  <div id="controls">
    <button id="prev">Previous</button>
    <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>
    <button id="next">Next</button>
    <button id="zoom_out">-</button>
    <button id="zoom_in">+</button>
  </div>
  <canvas id="the-canvas"></canvas>

  <!-- Load PDF.js -->
  <script src="../build/pdf.js"></script>
  <script>
    // Configure worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = "../build/pdf.worker.js";

    const url = "../2023-Trails-Book-Web-Version-reduced.pdf"; // ðŸ‘ˆ adjust if needed
    console.log("Attempting to load PDF:", url);

    let pdfDoc = null,
        pageNum = 1,
        scale = 1.0,
        canvas = document.getElementById("the-canvas"),
        ctx = canvas.getContext("2d");

    // Render page
    function renderPage(num) {
      console.log("Rendering page:", num);
      pdfDoc.getPage(num).then(function(page) {
        const viewport = page.getViewport({ scale: scale });
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        page.render(renderContext).promise.then(function() {
          console.log("Page rendered:", num);
        });
        document.getElementById("page_num").textContent = num;
      }).catch(err => console.error("Error rendering page:", err));
    }

    // Load the PDF
    pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
      console.log("PDF loaded successfully:", url);
      pdfDoc = pdfDoc_;
      document.getElementById("page_count").textContent = pdfDoc.numPages;
      renderPage(pageNum);
    }).catch(function(err) {
      console.error("Error loading PDF:", err);
    });

    // Button listeners
    document.getElementById("prev").addEventListener("click", function() {
      if (pageNum <= 1) return;
      pageNum--;
      renderPage(pageNum);
    });
    document.getElementById("next").addEventListener("click", function() {
      if (pageNum >= pdfDoc.numPages) return;
      pageNum++;
      renderPage(pageNum);
    });
    document.getElementById("zoom_in").addEventListener("click", function() {
      scale += 0.25;
      renderPage(pageNum);
    });
    document.getElementById("zoom_out").addEventListener("click", function() {
      if (scale <= 0.25) return;
      scale -= 0.25;
      renderPage(pageNum);
    });
  </script>
</body>
</html>
